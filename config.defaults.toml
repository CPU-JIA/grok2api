# ==================== 应用设置 ====================
[app]
# 应用访问地址（用于生成文件链接）
app_url = ""
# 后台管理密码
app_key = "grok2api"
# API 调用密钥（可选）
api_key = ""
# 是否启用 public 功能玩法
public_enabled = false
# Public 调用密钥（可选）
public_key = ""
# Web 管理/功能页会话签名密钥（建议设置强随机值）
session_secret = ""
# 后台会话有效期（小时）
admin_session_ttl_hours = 24
# Public 会话有效期（小时）
public_session_ttl_hours = 24
# 生成图片的格式（url 或 base64）
image_format = "url"
# 生成视频的格式（html 或 url）
video_format = "html"
# 是否启用临时对话模式
temporary = true
# 是否禁用 Grok 记忆功能
disable_memory = true
# 是否默认启用流式响应
stream = true
# 是否默认启用思维链输出
thinking = true
# 是否动态生成 Statsig 指纹
dynamic_statsig = true
# 过滤的特殊标签列表
filter_tags = ["xaiartifact","xai:tool_usage_card","grok:render"]


# ==================== 代理配置 ====================
[proxy]
# 基础代理地址（代理到 Grok 官网）
base_proxy_url = ""
# 资源代理地址（代理静态资源如图片/视频）
asset_proxy_url = ""
# 代理池 URL（返回代理地址）
pool_url = ""
# 代理池刷新间隔（秒）
pool_refresh_sec = 300
# 403 代理池重试次数
pool_403_max = 5
# Cloudflare Clearance Cookie
cf_clearance = ""
# curl_cffi 浏览器指纹
browser = "chrome136"
# User-Agent 字符串
user_agent = "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36"


# ==================== 重试策略 ====================
[retry]
# 最大重试次数
max_retry = 3
# 触发重试的 HTTP 状态码
retry_status_codes = [401,429,403]
# 触发重建 session 的 HTTP 状态码（用于轮换代理）
reset_session_status_codes = [403]
# 退避基础延迟（秒）
retry_backoff_base = 0.5
# 退避倍率
retry_backoff_factor = 2.0
# 单次重试最大延迟（秒）
retry_backoff_max = 20.0
# 总重试预算时间（秒）
retry_budget = 60.0


# ==================== Token 池管理 ====================
[token]
# 是否启用 Token 自动刷新
auto_refresh = true
# 普通 Token 刷新间隔（小时）
refresh_interval_hours = 8
# Super Token 刷新间隔（小时）
super_refresh_interval_hours = 2
# Token 连续失败阈值
fail_threshold = 5
# Token 变更保存延迟（毫秒）
save_delay_ms = 500
# 使用量写入最小间隔（秒）
usage_flush_interval_sec = 5
# 多 worker 状态同步间隔（秒）
reload_interval_sec = 30
# 普通错误次数冷却（请求次数）
cooldown_error_requests = 5
# 429 有额度冷却（秒）
cooldown_429_quota_sec = 3600
# 429 无额度冷却（秒）
cooldown_429_empty_sec = 36000

# ==================== 缓存管理 ====================
[cache]
# 是否启用自动清理
enable_auto_clean = true
# 缓存大小上限（MB）
limit_mb = 512

# ==================== 对话配置 ====================
[chat]
# Reverse 接口并发上限
concurrent = 50
# Reverse 接口超时时间（秒）
timeout = 60
# 流式空闲超时时间（秒）
stream_timeout = 120
# 流式首次响应超时（秒）
stream_first_timeout = 30
# 流式总超时（秒）
stream_total_timeout = 600

# ==================== 图像配置 ====================
[image]
# WebSocket 请求超时时间（秒）
timeout = 60
# WebSocket 流式空闲超时时间（秒）
stream_timeout = 120
# WebSocket 流式首次响应超时（秒）
stream_first_timeout = 30
# WebSocket 流式总超时（秒）
stream_total_timeout = 600
# 中等图后等待最终图的超时秒数
final_timeout = 15
# 是否启用 NSFW
nsfw = true
# 判定为中等质量图的最小字节数
medium_min_bytes = 30000
# 判定为最终图的最小字节数
final_min_bytes = 100000

# ==================== 视频配置 ====================
[video]
# Reverse 接口并发上限
concurrent = 100
# Reverse 接口超时时间（秒）
timeout = 60
# 流式空闲超时时间（秒）
stream_timeout = 120
# 流式首次响应超时（秒）
stream_first_timeout = 30
# 流式总超时（秒）
stream_total_timeout = 600

# ==================== 语音配置 ====================
[voice]
# Voice 请求超时时间（秒）
timeout = 60

# ==================== 资产配置 ====================
[asset]
# 上传并发数
upload_concurrent = 100
# 上传超时时间（秒）
upload_timeout = 60
# 下载并发数
download_concurrent = 100
# 下载超时时间（秒）
download_timeout = 60
# 资产查询并发数
list_concurrent = 100
# 资产查询超时时间（秒）
list_timeout = 60
# 资产查询批次大小（Token 维度）
list_batch_size = 50
# 资产删除并发数
delete_concurrent = 100
# 资产删除超时时间（秒）
delete_timeout = 60
# 资产删除批次大小（Token 维度）
delete_batch_size = 50

# ==================== NSFW ====================
[nsfw]
# NSFW 批量开启并发上限
concurrent = 60
# NSFW 批量开启批次大小
batch_size = 30
# NSFW 请求超时时间（秒）
timeout = 60

# ==================== 用量配置 ====================
[usage]
# Usage 批量开启并发上限
concurrent = 100
# Usage 批量开启批次大小
batch_size = 50
# Usage 请求超时时间（秒）
timeout = 60

# ==================== 会话管理 ====================
[conversation]
# 会话过期时间（秒）
ttl_seconds = 86400
# 每个 Token 最多保留会话数
max_per_token = 50
# 自动清理间隔（秒）
cleanup_interval_sec = 600
# 会话落盘合并延迟（毫秒）
save_delay_ms = 500

# ==================== 统计与日志 ====================
[stats]
# 小时统计保留数量
hourly_keep = 48
# 天统计保留数量
daily_keep = 30
# 统计写入合并延迟（毫秒）
save_delay_ms = 500

[logs]
# 日志保留条数
max_len = 2000
# 日志保存延迟（毫秒）
save_delay_ms = 500

[api_keys]
# API Key 保存延迟（毫秒）
save_delay_ms = 500


# ==================== MCP 配置 ====================
[mcp]
# 是否启用 MCP streamable-http 服务
enabled = true
# MCP 挂载路径
mount_path = "/mcp"
# MCP 访问令牌（为空时回退使用 app.api_key）
api_key = ""
